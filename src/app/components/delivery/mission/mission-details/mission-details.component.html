<div class="mission-dialog-overlay">
  <!-- Only show loading if missionId exists but mission data hasn't loaded yet -->
  <div class="mission-dialog-container loading-dialog" 
       *ngIf="missionId && !mission">
    <div class="loading-content">
      <div class="loading-icon"></div>
      <p>Loading mission details...</p>
    </div>
  </div>

  <!-- Show mission content when loaded -->
  <div class="mission-dialog-container" *ngIf="mission">
    <div class="dialog-header">
      <h2>Mission Details <span class="mission-id">#{{ mission.id.substring(0, 8) }}</span></h2>
      <button class="close-button" (click)="closeDialog()">&times;</button>
    </div>
    <div class="dialog-content">
      <div class="info-value">{{ mission.deliveryRequest.pickupAddress || 'Address not available' }}</div>
      <span class="status-badge">{{ mission.status }}</span>
    </div>
    
    <div class="mission-card">
      <div class="section">
        <h3>üìç Location Information</h3>
        <div class="info-row">
          <div class="info-label">From:</div>
          <div class="info-value">{{ mission.deliveryRequest.pickupAddress || 'Address not available' }}</div>
        </div>
        <div class="info-row">
          <div class="info-label">To:</div>
          <div class="info-value">{{ mission.deliveryRequest.deliveryAddress || 'Address not available' }}</div>
        </div>
        <div class="info-row">
          <div class="info-label">Status:</div>
          <div class="info-value">{{ mission.deliveryRequest.status }}</div>
        </div>
      </div>
      
      <div class="section">
        <h3>‚è±Ô∏è Timing</h3>
        <div class="info-row">
          <div class="info-label">Started:</div>
          <div class="info-value">
            {{ mission.parsedStartTime ? (mission.parsedStartTime | date:'medium') : 'Not started' }}
          </div>
        </div>
        <div class="info-row" *ngIf="mission.parsedEndTime">
          <div class="info-label">Completed:</div>
          <div class="info-value">
            {{ mission.parsedEndTime ? (mission.parsedEndTime | date:'medium') : 'Not completed' }}
          </div>
        </div>
        <div class="info-row" *ngIf="mission.parsedEndTime">
          <div class="info-label">Duration:</div>
          <div class="info-value">
            {{ calculateDuration(mission.parsedStartTime, mission.parsedEndTime) }}
          </div>
        </div>
      </div>
      
      <div class="section" *ngIf="mission.notes">
        <h3>üìù Notes</h3>
        <div class="notes">{{ mission.notes }}</div>
      </div>
    </div>
    
    <div class="dialog-actions">
      <ng-container *ngIf="mission.status === 'PENDING'">
        <button (click)="startMission(mission.id)" class="btn-start">Start Mission</button>
      </ng-container>
      
      <ng-container *ngIf="mission.status === 'IN_PROGRESS'">
        <button (click)="completeMission(mission.id)" class="btn-complete">Mark as Completed</button>
      </ng-container>
      
      <button (click)="closeDialog()" class="btn-close">Close</button>
    </div>
  </div>
  
  <div class="mission-dialog-container loading-dialog" *ngIf="!mission">
    <div class="loading-content">
      <div class="loading-icon"></div>
      <p>Loading mission details...</p>
    </div>
  </div>
</div>